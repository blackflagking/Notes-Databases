1、禁用sga自动管理机制，分配比较小的数据缓冲区(30m)和共享池(70m)空间，关闭PGA自动调优，分配（30m）。同时部署sp，每隔5分钟产生一个快照，快照的级别为7级。

2、创建序列：
CREATE SEQUENCE emp2_empno
           START WITH 1
      INCREMENT BY 1
      MAXVALUE 100000000
      CACHE 10000
      NOCYCLE;

3、往新建的表插入数据：

SQL> create table emp2 as select * from emp where 1=2;
SQL>  alter table emp2 modify empno number(10);
SQL>  alter table emp2 modify ENAME varchar2(30);
SQL> alter table emp2 nologging;

begin
  for i in 1..20000000 loop
    insert into emp2 nologging
    values (emp2_empno.nextval,'cuug'||i,'SALESMAN',7698,sysdate,1600,300,30);
    if mod(i,1000)=0 then 
    commit;
    end if;
  end loop;
  commit;
end;
/

需要大约10-20分钟
如果磁盘空间有限，也可在插入数据前设成非归档模式，节省6G空间。

4、运行查询业务：
  
[oracle@db bin]$ more share_pool_sql_1.sh 
#!/bin/bash

CNT=1
while [ $CNT -lt 20000000 ]
do
sqlplus scott/scott <<EOF
select * from emp2 where empno=$CNT;
exit
EOF
CNT=`expr $CNT + 1`
done  


5、根据快照产生2个以上的报告，关注:

1、关注load profile(工作负载），逻辑读、物理读、硬解析、登录次数、执行次数。
2、关注数据缓冲区命中率，各个时间段的具体统计。
3、top 5相关的等待事件，各个时间段的具体统计。
4、关注time model system stats （hard parse elaped time，connect ...
5、关注造成物理读最大的SQL语句，产生执行计划（核心内容）
6、关注advisory的建议

查看sp报告，提出存在的问题，至少三个，解释发生的原因，提出建议及解决方案。

解决第一个问题，然后再次收集SP，得出分析结果

解决第二个问题，然后再次收集SP，得出分析结果

解决第三个问题，然后再次收集SP，得出分析结果
--------------------------------------------------------------------